<!DOCTYPE html>
<html lang="en-US">

<head>
  <title>Logging</title>
  <meta charset='utf-8'>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,maximum-scale=2">

  <!-- stylesheets -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.1/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
  <link rel="stylesheet" href="/assets/main.css">
 
  <!-- favicon -->
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#603cba">
  <meta name="theme-color" content="#ffffff">
</head>


<body>
  <div class="bg-dark">
  <div class="container-fluid">
    <nav id="top-nav" class="navbar navbar-expand-sm navbar-dark bg-dark py-2 px-0">
      <!-- Logo -->
      <a class="ml-md-3 navbar-brand" href="/">
        <img class="float-left" src="/assets/images/logo/saros-logo.svg" />
        <span class="text-decoration-none pl-2 d-inline d-sm-none d-md-inline pr-5">Saros</span>
      </a>

      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup"
        aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
      <ul class="navbar-nav">
        
        
        
        
        <li class="nav-item ">
          <a class="nav-link font-weight-bold text-nowrap text-uppercase py-sm-2"
            href="/documentation">User Docs</a>
        </li>
        
        
        
        <li class="nav-item ">
          <a class="nav-link font-weight-bold text-nowrap text-uppercase py-sm-2"
            href="/releases">Releases</a>
        </li>
        
        
        
        <li class="nav-item active">
          <a class="nav-link font-weight-bold text-nowrap text-uppercase py-sm-2"
            href="/contribute">Contribute</a>
        </li>
        
        
        
        <li class="nav-item ">
          <a class="nav-link font-weight-bold text-nowrap text-uppercase py-sm-2"
            href="/contact">Contact</a>
        </li>
        
        
        
        <li class="nav-item ">
          <a class="nav-link font-weight-bold text-nowrap text-uppercase py-sm-2"
            href="/research">Research</a>
        </li>
        
      </ul>
      </div>

      <!-- Social Media -->
      <div id="media-links-nav" class="collapse navbar-collapse">
        </ul>
        <ul class="navbar-nav ml-auto">
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/saros-project/saros">
              <i class="fab fa-github fa-lg"> </i>
            </a>
          </li>
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://gitter.im/saros-project/saros/user">
              <i class="fab fa-gitter fa-lg"> </i>
            </a>
          </li>
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://groups.google.com/forum/#!forum/saros-user">
              <i class="fas fa-envelope fa-lg"> </i>
            </a>
          </li>
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://twitter.com/saros_project">
              <i class="fab fa-twitter fa-lg"> </i>
            </a>
          </li>
          
        </ul>
      </div>
    </nav>
  </div>
</div>

  <div class="container-fluid">

    
    

    

    <div class="row justify-content-left flex-xl-nowrap">
      <!-- Left sidebar -->
      <div class="col-12 col-md-4 col-xl-3 my-3 px-0  ">
        
        <div id="sidebar" class="pl-1">
    <ul class="nav flex-column">
        

        

        
        
        
        

        
        <li class="nav-item">
            <a class="nav-link not-collapsable-side-item  font-weight-bold py-0"
                href="/contribute/development-environment.html">Development Environment</a>
        </li>

        
        

        
        
        
        

        
        <li class="nav-item">
            <a class="nav-link not-collapsable-side-item  font-weight-bold py-0"
                href="/contribute/guidelines.html">Guidelines</a>
        </li>

        
        

        
        
        
        

        
        <li class="nav-item">
            <a class="nav-link not-collapsable-side-item  font-weight-bold py-0"
                href="/contribute/best-practices.html">Best Practices</a>
        </li>

        
        

        
        
        
        

        
        <li class="nav-item">
            <a class="nav-link not-collapsable-side-item  font-weight-bold py-0"
                href="/contribute/documentation.html">Documentation Writing</a>
        </li>

        
        

        
        
        
        

        
        <li class="nav-item">
            <a class="nav-link not-collapsable-side-item  font-weight-bold py-0"
                href="/contribute/saros-testing-framework.html">Saros Testing Framework</a>
        </li>

        
        

        
        
        
        

        
        <li class="nav-item">
            <a class="nav-link not-collapsable-side-item  font-weight-bold py-0"
                href="/contribute/saros-server.html">Saros Server Development</a>
        </li>

        
        

        
        
        
        

        
        <li class="nav-item">
            <a class="nav-link not-collapsable-side-item active-link font-weight-bold py-0"
                href="/contribute/logging.html">Logging</a>
        </li>

        
        

        
        
        
        

        
        
        <li class="nav-item">

            
            
            

            <a class="font-weight-bold nav-link py-0 collapsable-side-item collapsed" href="#Processes"
                data-target="#Processes" data-toggle="collapse">Processes</a>
            <div id="Processes" class="collapse ">
                <ul class="nav flex-column ml-2">
                    

                    
                    
                    

                    
                    <li class="nav-item"><a class="nav-link  py-0 pl-5"
                            href="/contribute/processes/development.html">Development Process</a></li>
                    

                    
                    
                    

                    
                    <li class="nav-item"><a class="nav-link  py-0 pl-5"
                            href="/contribute/processes/continuous-integration.html">Continuous Integration</a></li>
                    

                    
                    
                    

                    
                    <li class="nav-item"><a class="nav-link  py-0 pl-5"
                            href="/contribute/processes/review.html">Review Process</a></li>
                    

                    
                    
                    

                    
                    <li class="nav-item"><a class="nav-link  py-0 pl-5"
                            href="/contribute/processes/release.html">Release Process</a></li>
                    
                </ul>
            </div>
        </li>
        
        

        
        
        
        

        
        <li class="nav-item">
            <a class="nav-link not-collapsable-side-item  font-weight-bold py-0"
                href="/contribute/open-topics.html">Open Topics</a>
        </li>

        
        
    </ul>

</div>
        
      </div>

      <div id="main-content"
        class="col-12 col-md-8 col-lg-6 main-content my-3 px-sm-2 px-md-1 px-xl-0">

        <h1 class="display-4">Logging</h1>
        <p>All components of Saros are using the log4j2 framework as logging backend.
Since Saros is an IDE plugin, the log dir depends on the IDEs configurations.</p>

<h2 id="initializing-log4j2">Initializing log4j2</h2>

<p>Therefore, initializing the logging in Saros comprises the steps:</p>
<ol>
  <li>The default log4j2 initializing is executed that uses the configuration file <code class="language-plaintext highlighter-rouge">log4j2.xml</code> (has to be included in the classpath).</li>
  <li>Our custom initializing starts:
    <ul>
      <li>We determine the IDEs log directory and the required log level (e.g. <code class="language-plaintext highlighter-rouge">all</code> if Saros is running the debug-mode).</li>
      <li>We set the main arguments <code class="language-plaintext highlighter-rouge">logLevel</code> and <code class="language-plaintext highlighter-rouge">logDir</code>.</li>
      <li>We force log4j to reinitialize with the log configuration <code class="language-plaintext highlighter-rouge">saros_log4j2.xml</code> that uses the defined arguments ( with the format <code class="language-plaintext highlighter-rouge">main:&lt;argument&gt;</code>).</li>
    </ul>
  </li>
</ol>

<p>See the initializing in the classes <a href="https://github.com/saros-project/saros/blob/master/eclipse/src/saros/Saros.java"><code class="language-plaintext highlighter-rouge">Saros</code></a> (in Eclipse)
or <a href="https://github.com/saros-project/saros/blob/master/intellij/src/saros/intellij/SarosComponent.java"><code class="language-plaintext highlighter-rouge">SarosComponent</code></a> (in IntelliJ)
for example implementations. Sometimes (as in the Saros Server) using the default initializing is enough.</p>

<h2 id="ongoing-migration-from-log4j-12---log4j2">Ongoing migration from log4j-1.2 -&gt; log4j2</h2>

<p>In most cases, migrating to log4j2 and only requires to change the
used logger (see <a href="https://logging.apache.org/log4j/2.x/manual/migration.html">here</a> for more details):
<code class="language-plaintext highlighter-rouge">org.apache.log4j.Logger.getLogger()</code> -&gt; <code class="language-plaintext highlighter-rouge">org.apache.logging.log4j.LogManager.getLogger()</code></p>

<p>However, beside the required (minimal) migration step we should adopt the new functionality
of log4j2 that allow us to avoid log level checks.</p>

<h3 id="avoid-log-level-checks">Avoid log level checks</h3>

<p>With log4j2 supporting format string evaluation and (with Java 8) closure evaluation, we
can migrate logging statements as:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="o">(</span><span class="n">log</span><span class="o">.</span><span class="na">isTraceEnabled</span><span class="o">())</span>
  <span class="n">log</span><span class="o">.</span><span class="na">trace</span><span class="o">(</span>
  <span class="s">"id: "</span>
  <span class="o">+</span> <span class="n">namespaceId</span>
  <span class="o">+</span> <span class="s">" , namespace: "</span>
  <span class="o">+</span> <span class="n">namespace</span><span class="o">);</span>
</code></pre></div></div>
<p>to a format string</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">log</span><span class="o">.</span><span class="na">trace</span><span class="o">(</span><span class="s">"id: {}, namespace: {}"</span><span class="o">,</span> <span class="n">namespaceId</span><span class="o">,</span> <span class="n">namespace</span><span class="o">)</span>
</code></pre></div></div>
<p>or also a format string using a closure:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">log</span><span class="o">.</span><span class="na">trace</span><span class="o">(</span><span class="s">"id: {}, namespace: {}"</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">calculateId</span><span class="o">(),</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">namespace</span><span class="o">())</span>
</code></pre></div></div>

<div class="alert alert-warning" role="alert">
  <p>The <a href="https://logging.apache.org/log4j/2.x/log4j-api/apidocs/index.html">Log4j2 API</a> does not support to mix both variants.<br />
Therefore, <strong>the following is invalid</strong>:</p>

  <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">log</span><span class="o">.</span><span class="na">trace</span><span class="o">(</span><span class="s">"id: {}, namespace: {}"</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">calculateId</span><span class="o">(),</span> <span class="n">namespace</span><span class="o">)</span>
</code></pre></div>  </div>
</div>

<h3 id="log4j-12-api">Log4j-1.2-api</h3>

<p>In order to migrate from log4j-1.2 to log4j2 step-by-step
we use the additional project dependency <code class="language-plaintext highlighter-rouge">log4j2-1.2-api</code> that
routes all log4j-1.2 calls to log4j2.
As soon as we migrated all these calls, we can remove this dependency and this migration
documentation.</p>


      </div>

      <!-- Right sidebar (TOC) -->
      <div id="toc-bar-column" class="d-none d-lg-block col-12 col-lg-3 col-xl-3 px-0">
        
        <!-- element filled by loadToc() from toc.js -->
        <ul id="toc-bar" class="sticky-top text-decoration-none nav toc-bar py-3"></ul>
        
      </div>
    </div>
  </div>

  <footer class="page-footer font-small w-100 position-absolute">

  <div class="text-center my-3">
    
    
    <a href="https://github.com/saros-project/saros">
      <i class="fab fa-github fa-lg text-white mr-3 mr-md-5"> </i>
    </a>
    
    
    <a href="https://gitter.im/saros-project/saros/user">
      <i class="fab fa-gitter fa-lg text-white mr-3 mr-md-5"> </i>
    </a>
    
    
    <a href="https://groups.google.com/forum/#!forum/saros-user">
      <i class="fas fa-envelope fa-lg text-white mr-3 mr-md-5"> </i>
    </a>
    
    
    <a href="https://twitter.com/saros_project">
      <i class="fab fa-twitter fa-lg text-white "> </i>
    </a>
    
  </div>

</footer>
  <script src="/node_modules/jquery/dist/jquery.min.js"></script>
<script src="/node_modules/popper.js/dist/umd/popper.min.js"></script>
<script src="/node_modules/bootstrap/dist/js/bootstrap.min.js"></script>

<script src="/node_modules/mermaid/dist/mermaid.min.js"></script>
<script>
mermaid.initialize({
    startOnLoad: true
});
</script>
<!-- load after its dependency jquery -->

<script src="/assets/js/ide-tabs.js"></script>
<script src="/assets/js/toc.js"></script>
<script src="/assets/js/header-anchor-links.js"></script>

</body>

</html>